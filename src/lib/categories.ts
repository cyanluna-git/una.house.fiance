// 3-Level Category Hierarchy for Korean Personal Finance
// L1 (대분류) > L2 (중분류) > L3 (소분류)
// 목적: 재무 건전성 확보를 위한 투명한 지출 분류

export const CATEGORY_HIERARCHY: Record<string, Record<string, string[]>> = {
  "식자재": {
    "마트": ["코스트코", "이마트", "홈플러스", "롯데마트", "하나로마트", "기타마트"],
    "온라인식품": ["쿠팡프레시", "마켓컬리", "네이버쇼핑"],
    "전통시장": [],
    "편의점": ["GS25", "CU", "세븐일레븐", "이마트24"],
  },
  "외식비": {
    "한식": ["구내식당", "일반한식", "분식"],
    "중식": [],
    "일식": [],
    "양식": [],
    "패스트푸드": ["맥도날드", "버거킹", "롯데리아", "KFC"],
    "카페/음료": ["스타벅스", "컴포즈", "메가커피", "빽다방", "기타카페"],
    "배달": ["배달의민족", "쿠팡이츠", "요기요"],
    "베이커리": ["파리바게뜨", "뚜레쥬르", "성심당"],
  },
  "생활용품": {
    "다이소": [],
    "생활잡화": [],
    "주방용품": [],
    "세제/위생": [],
  },
  "공과금": {
    "전기": [],
    "수도": [],
    "가스": [],
    "인터넷": [],
    "통신": ["SKT", "KT", "LGU+"],
  },
  "구독": {
    "OTT": ["넷플릭스", "디즈니플러스", "왓챠", "웨이브", "쿠팡플레이"],
    "유튜브프리미엄": [],
    "음악": ["멜론", "스포티파이", "애플뮤직"],
    "클라우드": ["iCloud", "구글원", "드롭박스"],
    "멤버십": ["쿠팡로켓와우", "네이버플러스", "SSG"],
    "앱구독": ["앱스토어", "구글플레이"],
  },
  "교육": {
    "본인학원": [],
    "배우자학원": [],
    "자녀1학원": [],
    "자녀2학원": [],
    "학자금": [],
    "도서": ["서점", "전자책"],
    "온라인강의": [],
  },
  "보험": {
    "생명보험": ["종신", "연금", "저축성"],
    "손해보험": ["자동차보험", "화재보험"],
    "건강보험": ["실손", "건강"],
  },
  "대출": {
    "원금상환": ["주택대출", "신용대출", "학자금"],
    "이자상환": [],
  },
  "교통": {
    "대중교통": ["버스", "지하철", "기차", "시외버스"],
    "자동차": ["주유", "하이패스", "주차", "정비", "세차"],
    "택시": ["카카오택시", "일반택시"],
  },
  "의료": {
    "병원": ["종합병원", "의원", "한의원", "치과", "안과"],
    "약국": [],
    "건강검진": [],
  },
  "취미": {
    "자전거": [],
    "운동/헬스": ["헬스장", "수영", "필라테스", "요가"],
    "요리": [],
    "게임": [],
    "골프": [],
    "기타취미": [],
  },
  "여행": {
    "숙박": ["호텔", "펜션", "에어비앤비"],
    "교통": ["항공", "렌터카", "KTX"],
    "식대": [],
    "카페": [],
    "입장권": [],
    "쇼핑": [],
    "기타여행": [],
  },
  "쇼핑": {
    "온라인": ["쿠팡", "네이버", "해외직구"],
    "백화점": [],
    "의류/패션": ["의류", "신발", "악세서리"],
    "전자기기": [],
  },
  "금융": {
    "이자": ["대출이자", "카드이자"],
    "연회비": [],
    "세금": ["소득세", "재산세"],
    "수수료": ["송금수수료", "ATM수수료"],
  },
  "기부": {
    "정기후원": [],
    "일회성": [],
  },
  "기타": {
    "미분류": [],
    "기타지출": [],
  },
};

// 카테고리별 기본 necessity 매핑
export const NECESSITY_DEFAULTS: Record<string, "essential" | "discretionary"> = {
  "식자재": "essential",
  "외식비": "discretionary",
  "생활용품": "essential",
  "공과금": "essential",
  "구독": "discretionary",
  "교육": "essential",
  "보험": "essential",
  "대출": "essential",
  "교통": "essential",
  "의료": "essential",
  "취미": "discretionary",
  "여행": "discretionary",
  "쇼핑": "discretionary",
  "금융": "essential",
  "기부": "discretionary",
  "기타": "discretionary",
};

export function getL1Categories(): string[] {
  return Object.keys(CATEGORY_HIERARCHY);
}

export function getL2Categories(l1: string): string[] {
  return l1 && CATEGORY_HIERARCHY[l1] ? Object.keys(CATEGORY_HIERARCHY[l1]) : [];
}

export function getL3Categories(l1: string, l2: string): string[] {
  return l1 && l2 && CATEGORY_HIERARCHY[l1]?.[l2] ? CATEGORY_HIERARCHY[l1][l2] : [];
}

// Migration map: old L1 category -> new { l1, l2 }
export const MIGRATION_MAP: Record<string, { l1: string; l2: string }> = {
  "식비":     { l1: "외식비", l2: "" },
  "교통":     { l1: "교통", l2: "" },
  "쇼핑":     { l1: "쇼핑", l2: "" },
  "보험":     { l1: "보험", l2: "" },
  "통신":     { l1: "공과금", l2: "통신" },
  "의료":     { l1: "의료", l2: "" },
  "기부":     { l1: "기부", l2: "" },
  "수입":     { l1: "기타", l2: "기타지출" },
  "대출":     { l1: "대출", l2: "" },
  "주거":     { l1: "공과금", l2: "" },
  "여가/문화": { l1: "취미", l2: "" },
  "교육":     { l1: "교육", l2: "" },
  "금융":     { l1: "금융", l2: "" },
  "기타":     { l1: "기타", l2: "기타지출" },
  "미분류":   { l1: "기타", l2: "미분류" },
};
